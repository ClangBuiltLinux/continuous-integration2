From d485949afa2b0fa070818f54d1e94a03080d87dd Mon Sep 17 00:00:00 2001
From: Nathan Chancellor <nathan@kernel.org>
Date: Tue, 21 Sep 2021 13:49:16 -0700
Subject: [PATCH] x86/fpu/signal: Negate error code in save_xstate_epilog()

Link: https://lore.kernel.org/r/CADYN=9K1BdyupzcDAbyk2JTio1A98J9tsBS_LeOH4=GVG=7FqQ@mail.gmail.com/
Reported-by: Anders Roxell <anders.roxell@linaro.org>
Suggested-by: Anders Roxell <anders.roxell@linaro.org>
Signed-off-by: Nathan Chancellor <nathan@kernel.org>
---
 arch/x86/kernel/fpu/signal.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/arch/x86/kernel/fpu/signal.c b/arch/x86/kernel/fpu/signal.c
index 68f03da2012e..39c7bae97daf 100644
--- a/arch/x86/kernel/fpu/signal.c
+++ b/arch/x86/kernel/fpu/signal.c
@@ -106,7 +106,7 @@ static inline bool save_xstate_epilog(void __user *buf, int ia32_frame)
 	err = __copy_to_user(&x->i387.sw_reserved, sw_bytes, sizeof(*sw_bytes));
 
 	if (!use_xsave())
-		return err;
+		return !err;
 
 	err |= __put_user(FP_XSTATE_MAGIC2,
 			  (__u32 __user *)(buf + fpu_user_xstate_size));

base-commit: 83fa5857d812b46010841c677a90a3f858c2c838
-- 
2.33.0

