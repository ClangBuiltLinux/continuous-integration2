From c39922c263e62cb1a4b24d30cd8a3a517f55f2f1 Mon Sep 17 00:00:00 2001
From: Nathan Chancellor <nathan@kernel.org>
Date: Thu, 18 Nov 2021 09:23:27 -0700
Subject: [PATCH] HACK: ARM: Don't enable CONFIG_CURRENT_POINTER_IN_TPIDRURO
 with clang-14

While https://github.com/ClangBuiltLinux/linux/issues/1502 gets sorted
out.

Signed-off-by: Nathan Chancellor <nathan@kernel.org>
---
 arch/arm/Kconfig | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/arch/arm/Kconfig b/arch/arm/Kconfig
index f0f9e8bec83a..e21e59d10188 100644
--- a/arch/arm/Kconfig
+++ b/arch/arm/Kconfig
@@ -1164,7 +1164,7 @@ config SMP_ON_UP
 
 config CURRENT_POINTER_IN_TPIDRURO
 	def_bool y
-	depends on SMP && CPU_32v6K && !CPU_V6
+	depends on SMP && CPU_32v6K && !CPU_V6 && CLANG_VERSION < 140000
 
 config ARM_CPU_TOPOLOGY
 	bool "Support cpu topology definition"
-- 
2.34.0

